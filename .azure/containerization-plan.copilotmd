# **Containerization Plan**

## **Goal**
Setup Dockerfiles for the project to run inside of containers. Do not set up docker-compose for running locally as it is not required.

## **List of services to be containerized**

### 1. AssetManager Web Application
- **Path**: /workspaces/MicroHack-MigrateModernize/src/AssetManager/web
- **Language**: Java 25
- **Framework**: Spring Boot 3.5.0
- **Type**: Web application (REST API + Thymeleaf templates)
- **Dependencies**: 
  - Azure Blob Storage for file storage
  - Azure Service Bus for messaging
  - PostgreSQL database
  - Maven for build
- **Entrypoint**: Spring Boot web application (embedded Tomcat)
- **Port**: Typically 8080

### 2. AssetManager Worker Service
- **Path**: /workspaces/MicroHack-MigrateModernize/src/AssetManager/worker
- **Language**: Java 25
- **Framework**: Spring Boot 3.5.0
- **Type**: Background worker service
- **Dependencies**: 
  - Azure Blob Storage for file processing
  - Azure Service Bus for message consumption
  - Maven for build
- **Entrypoint**: Spring Boot background worker (thumbnail generation service)
- **Port**: No web interface (background service)

### 3. ContosoUniversity Application
- **Path**: /workspaces/MicroHack-MigrateModernize/src/ContosoUniversity
- **Language**: C# / .NET Framework 4.8
- **Framework**: ASP.NET MVC 5
- **Type**: Web application
- **Dependencies**: 
  - Entity Framework Core 3.1.32
  - SQL Server LocalDB (needs to be replaced with SQL Server for containerization)
  - MSMQ for message queuing
- **Entrypoint**: ASP.NET MVC web application (IIS)
- **Port**: Typically 80 or 443

## **Execution Steps**
> **Below are the steps for Copilot to follow; ask Copilot to update or execute this plan.**

Steps to containerize the project:

### 1. Check containerization pre-requisites
- Ensure Docker is installed and running.
- Verify build tools are available (Maven for Java, .NET SDK for C#).

### 2. Scan the repository
- Use tool 'appmod-analyze-repository' to analyze project structure and dependencies.

### 3. Check code readiness for containerization
- Ensure applications read configuration from environment variables (Azure configuration, database connections, etc.).
- Identify cloud dependencies that must be available:
  - Azure Blob Storage (for AssetManager)
  - Azure Service Bus (for AssetManager)
  - Azure Database for PostgreSQL (for AssetManager Web)
  - SQL Server database (for ContosoUniversity)
- Review any hardcoded configuration values that need to be externalized.

### 4. Create Dockerfiles for each project
For each service:
- Use tool 'appmod-plan-generate-dockerfile' to generate appropriate Dockerfiles.
- **AssetManager Web**: Multi-stage build with Maven, Java 25 runtime
- **AssetManager Worker**: Multi-stage build with Maven, Java 25 runtime
- **ContosoUniversity**: .NET Framework 4.8 Windows container with IIS

### 5. Build Docker images
For each project, build the Docker image:
- AssetManager Web: `docker build -t asset-manager-web:latest ./src/AssetManager/web`
- AssetManager Worker: `docker build -t asset-manager-worker:latest ./src/AssetManager/worker`
- ContosoUniversity: `docker build -t contoso-university:latest ./src/ContosoUniversity`
- Tag images with proper version numbers.
- Do not run containers (only build to verify Dockerfiles work).

### 6. Summarize containerization results
- List all Dockerfiles created.
- Document configuration changes required (environment variables, connection strings).
- List external dependencies needed for running containers.
- Provide next steps for deployment to Azure.
